<!DOCTYPE html>
<html lang="en">
<head>
    <title>User Stats</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/spryntax.css">
    <script src="/jquery-3.7.1.min.js"></script>
    <script src="/spryntax_main.js"></script>
</head>
<style>
    table, th, td {
        border: 1px solid white;
        margin: 0px auto;
        width: 120px;
        height: 50px;
        text-align: center;
    }
    button { 
        width: 100px;
        height: 50px;
        font-size: 15px;
        font-weight: bold;
    }
</style>

<body>
    <header>
        <div class="nav-container">
          <nav>
            <div class="nav-left">
              <!-- Spryntax: using white-to-cyan for default -->
              <a href="/" class="logo" data-gradient="linear-gradient(130deg, cyan, cyan)">Spryntax</a>
              <a href="/level_select" data-gradient="linear-gradient(130deg, cyan, lime)">Level Select</a>
              <a href="/favorites" data-gradient="linear-gradient(130deg, rgb(43, 255, 0), rgb(247, 255, 4))">Favorites</a>
              <a href="/stats" data-gradient="linear-gradient(130deg, rgb(247, 255, 4), rgb(255, 132, 0))">Stats</a>
              <a href="/leaderboard" data-gradient="linear-gradient(130deg, rgb(255, 132, 0), rgb(255, 0, 0))">Leaderboard</a>
              <a href="/report" data-gradient="linear-gradient(130deg, rgb(255, 0, 0), rgb(255, 0, 208))">Report</a>
            </div>
            <div class="nav-right">
              <a href="/settings" data-gradient="linear-gradient(130deg, rgb(255, 0, 208), rgb(81, 0, 255))">Settings</a>
              <% if (username && username !== 'undefined') { %>
                <a href="#" data-gradient="linear-gradient(130deg, rgb(81, 0, 255), rgb(0, 247, 255))">Welcome <%= username %>!</a>
              <% } else { %>
                <a href="/signup" data-gradient="linear-gradient(130deg, rgb(81, 0, 255), rgb(0, 247, 255))">Sign up</a>
                <a href="/login" data-gradient="linear-gradient(130deg, cyan, lime)">Log in</a>
              <% } %>
            </div>
            <div id="indicator"></div>
          </nav>
        </div>
    </header>

    <h1 class="gradient-text" data-text="User Statistics">User Statistics</h1>

    <!-- Filter buttons for Python and C++ stats -->
    <div style="margin: 0 auto; width: 656px; text-align: center;">
        <button class="python-button" onclick="filterStats('Python')">Python</button>
        <button class="c++-button" onclick="filterStats('C++')">C++</button>
    </div>

    <h3 style="text-align: center">All Stats</h3>
    <div class="stats-table">
        <table id="stats-table" style="width:60%">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Games Played</th>
                    <th>Average WPM</th>
                    <th>Best WPM</th>
                </tr>
            </thead>
            <tbody>
                <% stats.forEach(entry => { %>
                    <tr class="stats-row" data-language="<%= entry.program_language %>">
                        <td><%= entry.username %></td>
                        <td><%= entry.games_played %></td>
                        <td><%= entry.average_wpm %></td>
                        <td><%= entry.best_wpm %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    </div>

    <script>
        function filterStats(language) {
            const rows = document.querySelectorAll(".stats-row");
            const heading = document.querySelector("h3");

            rows.forEach(row => {
                row.style.display = (row.getAttribute("data-language") === language) ? "" : "none";
            });

            heading.textContent = `${language} Stats`;
        }
    </script>
</body>
</html>
